import { BitBuilder } from "./BitBuilder";



describe('BitBuilder', () => {
    it('should serialize uint', () => {
        let cases: [number, number, string][] = [
            [10290, 29, '00014194_'],
            [41732, 27, '0014609_'],
            [62757, 22, '03D496_'],
            [44525, 16, 'ADED'],
            [26925, 30, '0001A4B6_'],
            [52948, 27, '0019DA9_'],
            [12362, 20, '0304A'],
            [31989, 16, '7CF5'],
            [8503, 21, '0109BC_'],
            [54308, 17, '6A124_'],
            [61700, 25, '0078824_'],
            [63112, 20, '0F688'],
            [27062, 29, '00034DB4_'],
            [37994, 30, '000251AA_'],
            [47973, 27, '00176CB_'],
            [18996, 25, '00251A4_'],
            [34043, 21, '0427DC_'],
            [8234, 18, '080AA_'],
            [16218, 26, '000FD6A_'],
            [40697, 25, '004F7CC_'],
            [43740, 27, '00155B9_'],
            [35773, 31, '0001177B_'],
            [32916, 18, '20252_'],
            [1779, 24, '0006F3'],
            [35968, 17, '46404_'],
            [15503, 23, '00791F_'],
            [25860, 21, '032824_'],
            [20651, 29, '0002855C_'],
            [14369, 16, '3821'],
            [28242, 24, '006E52'],
            [28446, 18, '1BC7A_'],
            [48685, 16, 'BE2D'],
            [54822, 18, '3589A_'],
            [50042, 22, '030DEA_'],
            [11024, 30, '0000AC42_'],
            [44958, 26, '002BE7A_'],
            [20297, 27, '0009E93_'],
            [24757, 16, '60B5'],
            [36043, 29, '0004665C_'],
            [24210, 16, '5E92'],
            [49621, 29, '00060EAC_'],
            [63571, 17, '7C29C_'],
            [16047, 24, '003EAF'],
            [61384, 27, '001DF91_'],
            [57607, 25, '007083C_'],
            [32945, 30, '000202C6_'],
            [31215, 29, '0003CF7C_'],
            [3088, 21, '006084_'],
            [45519, 24, '00B1CF'],
            [53126, 26, '0033E1A_']
        ];
        for (let c of cases) {
            let builder = new BitBuilder();
            builder.writeUint(c[0], c[1]);
            let bits = builder.build();
            expect(bits.toString()).toBe(c[2]);
        }
    })
    it('should serialize int', () => {
        const cases: [number, number, string][] = [
            [-44028, 22, 'FD5012_'],
            [-1613, 16, 'F9B3'],
            [-3640, 23, 'FFE391_'],
            [45943, 22, '02CDDE_'],
            [-25519, 22, 'FE7146_'],
            [-31775, 31, 'FFFF07C3_'],
            [3609, 29, '000070CC_'],
            [-38203, 20, 'F6AC5'],
            [59963, 28, '000EA3B'],
            [-22104, 21, 'FD4D44_'],
            [1305, 21, '0028CC_'],
            [-40704, 30, 'FFFD8402_'],
            [39319, 20, '09997'],
            [-39280, 27, 'FFECD21_'],
            [48805, 21, '05F52C_'],
            [-47386, 21, 'FA3734_'],
            [-24541, 22, 'FE808E_'],
            [-11924, 30, 'FFFF45B2_'],
            [16173, 22, '00FCB6_'],
            [25833, 23, '00C9D3_'],
            [27830, 22, '01B2DA_'],
            [50784, 31, '00018CC1_'],
            [-41292, 22, 'FD7AD2_'],
            [-8437, 20, 'FDF0B'],
            [-42394, 19, 'EB4CD_'],
            [14663, 26, '000E51E_'],
            [-52314, 25, 'FF99D34_'],
            [22649, 31, '0000B0F3_'],
            [-60755, 19, 'E255B_'],
            [-28966, 17, 'C76D4_'],
            [44151, 20, '0AC77'],
            [22112, 26, '0015982_'],
            [25524, 19, '0C769_'],
            [55597, 23, '01B25B_'],
            [4434, 28, '0001152'],
            [28364, 29, '00037664_'],
            [-5431, 25, 'FFF564C_'],
            [35945, 17, '4634C_'],
            [49508, 19, '182C9_'],
            [-54454, 30, 'FFFCAD2A_'],
            [-62846, 22, 'FC2A0A_'],
            [-11725, 28, 'FFFD233'],
            [-25980, 30, 'FFFE6A12_'],
            [56226, 30, '00036E8A_'],
            [64224, 27, '001F5C1_'],
            [-52385, 29, 'FFF99AFC_'],
            [33146, 24, '00817A'],
            [-4383, 27, 'FFFDDC3_'],
            [4617, 23, '002413_'],
            [-20390, 21, 'FD82D4_']
        ];
        for (let c of cases) {
            let builder = new BitBuilder();
            builder.writeInt(c[0], c[1]);
            let bits = builder.build();
            expect(bits.toString()).toBe(c[2]);
        }
    })
});